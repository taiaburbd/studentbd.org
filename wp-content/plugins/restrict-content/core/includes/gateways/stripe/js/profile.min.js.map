{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./core/includes/gateways/stripe/js/profile.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","errorContainer","cardContainer","container","document","getElementById","let","$","jQuery","innerHTML","createElement","id","appendChild","rcpStripeUpdateElementStyles","rcpStripe","elements","card","mount","addEventListener","rcpStripeToggleElementErrors","savedPaymentMethod","newCardFields","on","val","show","hide","trigger","RCP_Stripe_Manage_Cards","init","delete","e","preventDefault","confirm","rcp_stripe_script_options","confirm_delete_card","paymentMethod","this","errorWrap","data","text","pleasewait","empty","ajax","type","dataType","url","ajaxurl","action","payment_method_id","nonce","xhrFields","withCredentials","success","response","parents","remove","console","log","append","fail","window","rcpStripeHandleCardUpdateError","message","code","errors","unblock","error","prop","form","rcpStripeSubmitBillingCardUpdate","cardHolderName","querySelector","submitButton","paymentMethodID","block","css","border","padding","backgroundColor","opacity","color","membership_id","args","payment_method","billing_details","handler","payment_intent_object","client_secret","payment_intent_client_secret","Stripe","then","result","rcpStripeHandleCardUpdateSuccess","inputField","objectField","payment_intent_id","removeEventListener","submit","enter_card_name"],"mappings":"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","file":"profile.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/* global rcpStripe, rcpStripeToggleElementErrors, rcp_stripe_script_options */\n\n// Setup on page load.\n( function() {\n\tvar container = document.getElementById( 'rcp-card-wrapper' );\n\n\tif ( ! container ) {\n\t\treturn;\n\t}\n\n\tlet $ = jQuery;\n\n\tif ( ! document.getElementById( 'rcp-card-element' ) || ! document.getElementById( 'rcp-card-element-errors' ) ) {\n\t\tcontainer.innerHTML = '';\n\n\t\t// Need to dynamically generate a container to hold errors under the card field.\n\t\tvar errorContainer = document.createElement( 'div' );\n\t\terrorContainer.id = 'rcp-card-element-errors';\n\n\t\tvar cardContainer = document.createElement( 'div' );\n\t\tcardContainer.id = 'rcp-card-element';\n\n\t\tcontainer.appendChild( cardContainer );\n\t\tcontainer.appendChild( errorContainer );\n\t}\n\n\t// Update element styles.\n\trcpStripeUpdateElementStyles( rcpStripe.elements.card, '.rcp_card_name' );\n\n\t// Field is available, mount.\n\trcpStripe.elements.card.mount( '#rcp-card-element' );\n\n\t// Handle errors.\n\trcpStripe.elements.card.addEventListener( 'change', rcpStripeToggleElementErrors );\n\n\t// Show / hide new card fields.\n\tlet savedPaymentMethod = $( 'input[name=\"rcp_gateway_existing_payment_method\"]' );\n\tlet newCardFields      = $( '.rcp-gateway-new-card-fields' );\n\n\t/**\n\t * Listen for selected payment method changing.\n\t */\n\tsavedPaymentMethod.on( 'change', function() {\n\t\tlet value = $( 'input[name=\"rcp_gateway_existing_payment_method\"]:checked' ).val();\n\t\tif ( 'new' === value ) {\n\t\t\tnewCardFields.show();\n\t\t} else {\n\t\t\tnewCardFields.hide();\n\t\t}\n\t} );\n\n\t// Trigger change event so we can determine new vs saved card right off the bat.\n\tsavedPaymentMethod.trigger( 'change' );\n\n\t/**\n\t * Saved card management.\n\t */\n\tvar RCP_Stripe_Manage_Cards = {\n\n\t\t/**\n\t\t * Initialize\n\t\t */\n\t\tinit: function() {\n\t\t\t$( '.rcp-gateway-saved-card-delete' ).on( 'click', 'a', RCP_Stripe_Manage_Cards.delete );\n\t\t},\n\n\t\t/**\n\t\t * Delete a payment method\n\t\t */\n\t\tdelete: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tif ( ! confirm( rcp_stripe_script_options.confirm_delete_card ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet paymentMethod = $( this );\n\t\t\tlet errorWrap     = $( '#rcp-card-element-errors' );\n\n\t\t\tpaymentMethod.data( 'text', paymentMethod.text() ).text( rcp_stripe_script_options.pleasewait );\n\t\t\terrorWrap.empty();\n\n\t\t\t$.ajax( {\n\t\t\t\ttype: 'post',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: rcp_stripe_script_options.ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'rcp_stripe_delete_saved_payment_method',\n\t\t\t\t\tpayment_method_id: paymentMethod.data( 'id' ),\n\t\t\t\t\tnonce: paymentMethod.data( 'nonce' )\n\t\t\t\t},\n\t\t\t\txhrFields: {\n\t\t\t\t\twithCredentials: true\n\t\t\t\t},\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( response.success ) {\n\t\t\t\t\t\tpaymentMethod.parents( 'li' ).remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log( response );\n\t\t\t\t\t\terrorWrap.append( '<div class=\"rcp_message error\"><p class=\"rcp_error\"><span>' + response.data + '</span></p></div>' );\n\t\t\t\t\t\tpaymentMethod.text( paymentMethod.data( 'text' ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} ).fail( function( response ) {\n\t\t\t\tif ( window.console && window.console.log ) {\n\t\t\t\t\tconsole.log( response );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t};\n\n\tRCP_Stripe_Manage_Cards.init();\n} )();\n\n/**\n * Attempt to generate a token when the form is submitted.\n *\n * @param {Event} e Form submission event.\n */\nfunction rcpStripeSubmitBillingCardUpdate( e ) {\n\t// Halt here.\n\te.preventDefault();\n\n\tlet cardHolderName  = document.querySelector( '.rcp_card_name' ).value;\n\tlet submitButton    = jQuery( '#rcp_submit' );\n\tlet form            = jQuery( '#rcp_update_card_form' );\n\tlet paymentMethodID = jQuery( 'input[name=\"rcp_gateway_existing_payment_method\"]:checked' ).val();\n\n\tif ( 'new' === paymentMethodID ) {\n\t\tpaymentMethodID = false;\n\t}\n\n\tif ( ! paymentMethodID && '' === cardHolderName ) {\n\t\trcpStripeHandleCardUpdateError( rcp_stripe_script_options.enter_card_name );\n\n\t\treturn;\n\t}\n\n\tsubmitButton.prop( 'disabled', true );\n\n\tform.block( {\n\t\tmessage: rcp_stripe_script_options.pleasewait,\n\t\tcss: {\n\t\t\tborder: 'none',\n\t\t\tpadding: '15px',\n\t\t\tbackgroundColor: '#000',\n\t\t\t'-webkit-border-radius': '10px',\n\t\t\t'-moz-border-radius': '10px',\n\t\t\topacity: .5,\n\t\t\tcolor: '#fff'\n\t\t}\n\t} );\n\n\t/**\n\t * Create a setup intent.\n\t */\n\tjQuery.ajax( {\n\t\ttype: 'post',\n\t\tdataType: 'json',\n\t\turl: rcp_stripe_script_options.ajaxurl,\n\t\tdata: {\n\t\t\taction: 'rcp_stripe_create_setup_intent_for_saved_card',\n\t\t\tmembership_id: jQuery( 'input[name=\"rcp_membership_id\"]' ).val(),\n\t\t\tpayment_method_id: paymentMethodID ? paymentMethodID : 'new'\n\t\t},\n\t\tsuccess: function ( response ) {\n\t\t\tif ( response.success ) {\n\t\t\t\tlet args = {\n\t\t\t\t\tpayment_method: {\n\t\t\t\t\t\tcard: rcpStripe.elements.card,\n\t\t\t\t\t\tbilling_details: { name: cardHolderName }\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif ( paymentMethodID ) {\n\t\t\t\t\targs = {\n\t\t\t\t\t\tpayment_method: paymentMethodID\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tlet handler = 'payment_intent' === response.data.payment_intent_object ? 'confirmCardPayment' : 'confirmCardSetup';\n\n\t\t\t\t/*\n\t\t\t\t * Payment Intent\n\t\t\t\t * Handle a card payment.\n\t\t\t\t */\n\t\t\t\trcpStripeHandleIntent(\n\t\t\t\t\thandler, response.data.payment_intent_client_secret, args\n\t\t\t\t).then( function( result ) {\n\t\t\t\t\tif ( result.error ) {\n\t\t\t\t\t\trcpStripeHandleCardUpdateError( result.error.message, result.error.code );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Success\n\t\t\t\t\t\trcpStripeHandleCardUpdateSuccess( response );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\trcpStripeHandleCardUpdateError( response.data );\n\t\t\t}\n\t\t}\n\t} );\n}\n\n/**\n * Handles a Stripe payment / setup intent, dynamically factoring in:\n *      - Saved vs new payment method\n *      - Setup Intent vs Payment Intent\n *\n * @param {string}  handler              Stripe handler to call - either `handleCardPayment` or `confirmCardSetup`.\n * @param {string}  client_secret        Client secret to pass into the function.\n * @param {object}  args                 Arguments to pass into the function. For a saved payment method this\n *                                       should contain the payment method ID. For a new payment method this\n *                                       might contain the billing card name.\n *\n * @since 3.3\n * @return {Promise}\n */\nfunction rcpStripeHandleIntent( handler, client_secret, args ) {\n\treturn rcpStripe.Stripe[ handler ]( client_secret, args );\n}\n\n/**\n * Handle card update success\n *      - Add `stripe_payment_intent_id` hidden field.\n *      - Add `stripe_payment_intent_object` hidden field.\n *\n * @param {object} response Ajax response.\n *\n * @since 3.2\n */\nfunction rcpStripeHandleCardUpdateSuccess( response ) {\n\tlet inputField = document.createElement( 'input' );\n\tinputField.value = response.data.payment_intent_id;\n\tinputField.type = 'hidden';\n\tinputField.name = 'stripe_payment_intent_id';\n\n\tform.appendChild( inputField );\n\n\tlet objectField = document.createElement( 'input' );\n\tobjectField.value = response.data.payment_intent_object;\n\tobjectField.type = 'hidden';\n\tobjectField.name = 'stripe_payment_intent_object';\n\n\tform.appendChild( objectField );\n\n\t// Re-submit form.\n\tform.removeEventListener( 'submit', rcpStripeSubmitBillingCardUpdate );\n\tform.submit();\n}\n\n/**\n * Handle card update failures\n *      - Show error message.\n *      - Re-enable submit button.\n *\n * @param {string} message Error message to display.\n * @param {string} code Optional. Error code.\n *\n * @since 3.2\n */\nfunction rcpStripeHandleCardUpdateError( message, code = '' ) {\n\n\t// Use localized error message if available.\n\tif ( '' !== code && 'undefined' !== typeof rcpStripe.errors[code] ) {\n\t\tmessage = rcpStripe.errors[code];\n\t}\n\n\tjQuery( '#rcp_update_card_form' ).unblock();\n\n\trcpStripeToggleElementErrors( {\n\t\terror: {\n\t\t\tmessage: message\n\t\t}\n\t} );\n\n\tjQuery( '#rcp_submit' ).prop( 'disabled', false );\n\n}\n\nvar form = document.getElementById( 'rcp_update_card_form' );\n\nform.addEventListener( 'submit', rcpStripeSubmitBillingCardUpdate );\n"],"sourceRoot":""}